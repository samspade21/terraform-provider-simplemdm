---
page_title: "simplemdm_customdeclaration Resource - terraform-provider-simplemdm"
subcategory: ""
description: |-
  Manages Declarative Device Management (DDM) custom declarations in SimpleMDM.
---

# simplemdm_customdeclaration (Resource)

Manages Declarative Device Management (DDM) custom declarations in SimpleMDM. Custom declarations enable modern device management capabilities for supported Apple devices, allowing you to define configurations and policies that are evaluated and applied declaratively by the device.

## Example Usage

### Basic Example

```terraform
resource "simplemdm_customdeclaration" "example" {
  name             = "Custom Configuration"
  identifier       = "com.example.custom.config"
  declaration_type = "com.apple.configuration.management.properties"
  platforms        = ["iOS", "macOS"]
  
  data = jsonencode({
    ServiceType = "com.apple.mdm"
    DataAssetType = "com.apple.ManagedApplicationConfiguration"
  })
}
```

### Advanced Example - With Activation Predicate

```terraform
resource "simplemdm_customdeclaration" "conditional_config" {
  name             = "iOS 17+ Configuration"
  identifier       = "com.example.ios17.config"
  declaration_type = "com.apple.configuration.management.properties"
  description      = "Configuration for devices running iOS 17 or later"
  platforms        = ["iOS"]
  active           = true
  
  # Only activate on devices running iOS 17+
  activation_predicate = "system.os.version >= 17.0"
  
  data = jsonencode({
    ServiceType = "com.apple.mdm"
    Settings = {
      EnableFeature = true
    }
  })
}
```

### Advanced Example - With Variable Support

```terraform
resource "simplemdm_attribute" "api_endpoint" {
  name          = "api_endpoint"
  default_value = "https://api.example.com"
}

resource "simplemdm_customdeclaration" "app_config" {
  name              = "Application Configuration"
  identifier        = "com.example.app.config"
  declaration_type  = "com.apple.configuration.management.properties"
  platforms         = ["iOS", "macOS"]
  attribute_support = true
  escape_attributes = true
  
  data = jsonencode({
    ServiceType = "com.apple.mdm"
    Settings = {
      APIEndpoint = "$api_endpoint"  # Variable will be replaced
      Environment = "$environment"
    }
  })
}
```

### Advanced Example - User Scope Declaration

```terraform
resource "simplemdm_customdeclaration" "user_preferences" {
  name             = "User Preferences"
  identifier       = "com.example.user.prefs"
  declaration_type = "com.apple.configuration.management.properties"
  platforms        = ["macOS"]
  user_scope       = true  # Apply to user context
  priority         = 100
  
  data = jsonencode({
    ServiceType = "com.apple.mdm"
    Preferences = {
      Theme = "dark"
      Notifications = true
    }
  })
}
```

### Advanced Example - With Device Assignment

```terraform
resource "simplemdm_customdeclaration" "security_policy" {
  name             = "Security Policy"
  identifier       = "com.example.security"
  declaration_type = "com.apple.configuration.management.properties"
  platforms        = ["iOS", "macOS"]
  active           = true
  
  data = jsonencode({
    ServiceType = "com.apple.mdm"
    SecuritySettings = {
      RequireEncryption = true
      AllowUSB = false
    }
  })
}

# Assign declaration to specific device
resource "simplemdm_customdeclaration_device_assignment" "assignment" {
  custom_declaration_id = simplemdm_customdeclaration.security_policy.id
  device_id             = "123456"
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `data` (String) JSON payload of the declaration data.
- `declaration_type` (String) Declaration type reported to Apple devices.
- `identifier` (String) Unique declaration identifier. Changing forces replacement.
- `name` (String) Human readable name for the declaration.
- `platforms` (Set of String) List of platforms that should receive the declaration.

### Optional

- `activation_predicate` (String) Predicate that controls when the declaration activates on a device.
- `active` (Boolean) Whether the declaration is active.
- `attribute_support` (Boolean) Enable variable expansion when processing the declaration payload.
- `description` (String) Optional description of the declaration.
- `escape_attributes` (Boolean) Escape the values of custom variables within the payload before delivery.
- `priority` (Number) Optional priority value used for ordering declarations.
- `topic` (String) Optional topic used for declarative management payloads.
- `transport` (String) Optional transport mechanism for the declaration.
- `user_scope` (Boolean) Whether the declaration is scoped to users (true) or devices (false). Defaults to true.

### Read-Only

- `created_at` (String) Timestamp when the declaration was created in SimpleMDM.
- `device_count` (Number) Number of devices currently assigned to the declaration.
- `group_count` (Number) Number of device groups currently assigned to the declaration.
- `id` (String) The unique identifier of the declaration in SimpleMDM.
- `payload` (String) Alias that mirrors the JSON payload returned by the SimpleMDM download endpoint.
- `profile_identifier` (String) Identifier assigned by SimpleMDM for tracking the declaration profile.
- `updated_at` (String) Timestamp when the declaration was last updated in SimpleMDM.

## Import

Import is supported using the following syntax:

```shell
# Custom declaration can be imported by specifying the declaration ID
terraform import simplemdm_customdeclaration.example 123456
```

## Notes

- **DDM Support**: Declarative Device Management is supported on iOS 15+, iPadOS 15+, and macOS 13+.
- **Identifier Uniqueness**: The `identifier` must be unique across all declarations. Changing it forces resource replacement.
- **Activation Predicates**: Use predicates to control when declarations activate based on device properties (OS version, model, etc.).
- **Variable Support**: When `attribute_support` is enabled, you can use SimpleMDM custom attributes in your declaration data using `$attribute_name` syntax.
- **Escaping**: Enable `escape_attributes` to properly escape attribute values in JSON/XML payloads.
- **Priority**: Lower priority numbers are evaluated first when multiple declarations apply to a device.
- **User vs Device Scope**: Set `user_scope = false` for device-level declarations, or `true` for user-level declarations.
- **Device Assignment**: Use the `simplemdm_customdeclaration_device_assignment` resource to assign declarations to specific devices.