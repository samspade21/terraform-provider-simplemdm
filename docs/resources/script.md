---
page_title: "simplemdm_script Resource - terraform-provider-simplemdm"
subcategory: ""
description: |-
  Manages scripts in SimpleMDM that can be executed on macOS devices.
---

# simplemdm_script (Resource)

Manages scripts in SimpleMDM. Scripts can be executed on macOS devices through script jobs, allowing you to automate device configuration, gather information, or perform maintenance tasks remotely.

## Example Usage

### Basic Example

```terraform
resource "simplemdm_script" "hello_world" {
  name       = "Hello World"
  scriptfile = <<-EOT
    #!/bin/bash
    echo "Hello from SimpleMDM!"
  EOT
}
```

### Advanced Example - From File

```terraform
resource "simplemdm_script" "system_info" {
  name            = "Gather System Information"
  scriptfile      = file("${path.module}/scripts/system_info.sh")
  variablesupport = false
}
```

### Advanced Example - With Variable Support

```terraform
resource "simplemdm_attribute" "api_token" {
  name          = "api_token"
  default_value = "default-token-value"
}

resource "simplemdm_script" "api_call" {
  name            = "Call API with Custom Token"
  variablesupport = true
  scriptfile      = <<-EOT
    #!/bin/bash
    # This script uses SimpleMDM variable substitution
    API_TOKEN="$api_token"
    curl -H "Authorization: Bearer $API_TOKEN" https://api.example.com/status
  EOT
}
```

### Advanced Example - Complex Script

```terraform
resource "simplemdm_script" "maintenance" {
  name            = "System Maintenance"
  variablesupport = false
  scriptfile      = <<-EOT
    #!/bin/bash
    set -e
    
    # Update Homebrew
    echo "Updating Homebrew..."
    /usr/local/bin/brew update
    
    # Clean up old logs
    echo "Cleaning up logs..."
    find /var/log -type f -name "*.log" -mtime +30 -delete
    
    # Report completion
    echo "Maintenance completed successfully"
  EOT
}
```

### Advanced Example - Using templatefile

```terraform
resource "simplemdm_script" "templated" {
  name            = "Templated Configuration"
  variablesupport = false
  scriptfile      = templatefile("${path.module}/scripts/config.sh.tpl", {
    environment = "production"
    log_level   = "info"
  })
}
```

### Advanced Example - With Script Job

```terraform
resource "simplemdm_script" "inventory" {
  name       = "Collect Device Inventory"
  scriptfile = file("${path.module}/scripts/inventory.sh")
}

# Execute the script on devices
resource "simplemdm_scriptjob" "inventory_job" {
  script_id              = simplemdm_script.inventory.id
  device_ids             = ["123456", "234567"]
  custom_attribute       = "last_inventory"
  custom_attribute_regex = "\\n"
}
```

### Advanced Example - Multiple Scripts

```terraform
locals {
  scripts = {
    backup = {
      name = "Backup User Data"
      file = "backup.sh"
    }
    cleanup = {
      name = "Cleanup Temp Files"
      file = "cleanup.sh"
    }
    update = {
      name = "Update Applications"
      file = "update.sh"
    }
  }
}

resource "simplemdm_script" "maintenance_scripts" {
  for_each = local.scripts
  
  name       = each.value.name
  scriptfile = file("${path.module}/scripts/${each.value.file}")
}
```

### Advanced Example - Inline Multi-line Script

```terraform
resource "simplemdm_script" "configure_device" {
  name            = "Configure Device Settings"
  variablesupport = true
  scriptfile      = <<-EOT
    #!/bin/bash
    
    # Script to configure device settings
    # Variables: $device_name, $time_zone
    
    # Set computer name
    if [ -n "$device_name" ]; then
        sudo scutil --set ComputerName "$device_name"
        sudo scutil --set LocalHostName "$device_name"
        sudo scutil --set HostName "$device_name"
    fi
    
    # Set time zone
    if [ -n "$time_zone" ]; then
        sudo systemsetup -settimezone "$time_zone"
    fi
    
    # Enable Remote Desktop
    sudo /System/Library/CoreServices/RemoteManagement/ARDAgent.app/Contents/Resources/kickstart \
        -activate -configure -access -on -restart -agent -privs -all
    
    echo "Configuration complete"
  EOT
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) A name for the script. Example: "System Maintenance Script"
- `scriptfile` (String) The script content. Can be directly specified as a string, or loaded using `file()` or `templatefile()` functions. Example: `file("./scripts/script.sh")`

### Optional

- `variablesupport` (Boolean) Whether to enable variable support in this script. When enabled, SimpleMDM custom attributes can be referenced using `$attribute_name` syntax. Default: `false`.

### Read-Only

- `created_at` (String) Timestamp when the script was created in SimpleMDM.
- `created_by` (String) User or API key that created the script in SimpleMDM.
- `id` (String) The unique identifier of the script in SimpleMDM.
- `updated_at` (String) Timestamp when the script was last updated in SimpleMDM.

## Import

Import is supported using the following syntax:

```shell
# Script can be imported by specifying the numeric identifier
terraform import simplemdm_script.example 123456
```

## Notes

- **Platform Support**: Scripts are only executed on macOS devices.
- **Variable Substitution**: When `variablesupport = true`, use `$attribute_name` in your script to reference SimpleMDM custom attributes. These will be replaced with actual values before execution.
- **Script Format**: Scripts should include a proper shebang (e.g., `#!/bin/bash`) and should be executable.
- **Exit Codes**: Script execution success is determined by the exit code. Return 0 for success, non-zero for failure.
- **Output Capture**: Script output (stdout/stderr) can be captured and stored in custom attributes via script jobs.
- **Permissions**: Scripts run with appropriate permissions on the device. Use `sudo` if elevated privileges are needed.
- **Script Updates**: Changing the `scriptfile` content will update the script in SimpleMDM but does not automatically re-execute it on devices.
- **Execution**: Scripts are executed through `simplemdm_scriptjob` resources, not directly by this resource.
- **Best Practices**:
  - Use `set -e` to exit on errors
  - Include error handling and logging
  - Test scripts locally before deployment
  - Use variables for environment-specific values
  - Keep scripts idempotent when possible