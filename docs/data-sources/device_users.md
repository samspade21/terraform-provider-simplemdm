---
page_title: "simplemdm_device_users Data Source - terraform-provider-simplemdm"
subcategory: ""
description: |-
  Retrieves the list of user accounts currently configured on a macOS device.
---

# simplemdm_device_users (Data Source)

Retrieves the list of user accounts currently configured on a macOS device. This data source provides information about all user accounts on the device, including admin users, standard users, and their properties.

## Example Usage

### Basic Example

```terraform
data "simplemdm_device_users" "mac_users" {
  device_id = "123456"
}

output "user_count" {
  value = length(data.simplemdm_device_users.mac_users.users)
}
```

### Advanced Example - Parse User Attributes

```terraform
data "simplemdm_device_users" "device_users" {
  device_id = "123456"
}

locals {
  users = [
    for user in data.simplemdm_device_users.device_users.users :
    jsondecode(user.attributes_json)
  ]
}

output "usernames" {
  value = [for user in local.users : user.username]
}
```

### Advanced Example - Find Admin Users

```terraform
data "simplemdm_device_users" "all_users" {
  device_id = "123456"
}

locals {
  parsed_users = [
    for user in data.simplemdm_device_users.all_users.users :
    jsondecode(user.attributes_json)
  ]
  
  admin_users = [
    for user in local.parsed_users :
    user if lookup(user, "is_admin", false) == true
  ]
}

output "admin_usernames" {
  value = [for user in local.admin_users : user.username]
}
```

### Advanced Example - User Account Report

```terraform
data "simplemdm_device_users" "audit" {
  device_id = "123456"
}

locals {
  users_list = [
    for user in data.simplemdm_device_users.audit.users :
    jsondecode(user.attributes_json)
  ]
}

output "users_report" {
  value = {
    total_users = length(local.users_list)
    users = [
      for user in local.users_list : {
        username        = lookup(user, "username", "Unknown")
        full_name       = lookup(user, "full_name", "Unknown")
        is_admin        = lookup(user, "is_admin", false)
        has_secure_token = lookup(user, "has_secure_token", false)
      }
    ]
  }
}
```

### Advanced Example - Check for Specific User

```terraform
data "simplemdm_device_users" "check_device" {
  device_id = "123456"
}

locals {
  users = [
    for user in data.simplemdm_device_users.check_device.users :
    jsondecode(user.attributes_json)
  ]
  
  has_admin_user = anytrue([
    for user in local.users :
    lookup(user, "username", "") == "admin" && lookup(user, "is_admin", false)
  ])
}

output "admin_exists" {
  value = local.has_admin_user ? "Admin user exists" : "Admin user not found"
}
```

### Advanced Example - Secure Token Analysis

```terraform
data "simplemdm_device_users" "security_audit" {
  device_id = "123456"
}

locals {
  parsed_users = [
    for user in data.simplemdm_device_users.security_audit.users :
    jsondecode(user.attributes_json)
  ]
  
  secure_token_users = [
    for user in local.parsed_users :
    user if lookup(user, "has_secure_token", false)
  ]
}

output "secure_token_info" {
  value = {
    total_users           = length(local.parsed_users)
    secure_token_users    = length(local.secure_token_users)
    secure_token_usernames = [for user in local.secure_token_users : user.username]
  }
}
```

### Advanced Example - Multiple Devices Comparison

```terraform
locals {
  device_ids = ["123456", "234567", "345678"]
}

data "simplemdm_device_users" "devices_users" {
  for_each  = toset(local.device_ids)
  device_id = each.value
}

output "devices_user_counts" {
  value = {
    for device_id, users_data in data.simplemdm_device_users.devices_users :
    device_id => length(users_data.users)
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `device_id` (String) Identifier of the device.

### Read-Only

- `users` (Block List) Collection of user accounts present on the device. (see [below for nested schema](#nestedblock--users))

<a id="nestedblock--users"></a>
### Nested Schema for `users`

Read-Only:

- `attributes_json` (String) Raw attributes payload returned by the API in JSON format.
- `id` (String) User identifier.
- `type` (String) User resource type.

## Notes

- **macOS Only**: This data source is only applicable to macOS devices. It will not return data for iOS/iPadOS devices.
- **JSON Parsing**: Use `jsondecode()` to parse the `attributes_json` field and access user details.
- **User Attributes**: Common attributes in the JSON payload include:
  - `username` - User account name
  - `full_name` - User's full name
  - `is_admin` - Whether the user has admin privileges
  - `has_secure_token` - Whether the user has a secure token (macOS 10.13+)
  - `uid` - User ID
  - `home_directory` - Home directory path
- **Secure Token**: Secure tokens are required for FileVault and other security features on modern macOS.
- **Real-time Data**: Reflects the most recent user account inventory reported by the device.
- **Use Cases**:
  - Audit user accounts across Mac fleet
  - Verify admin account configuration
  - Check secure token status for FileVault compliance
  - Identify unauthorized accounts
  - Generate user inventory reports
  - Validate account management policies